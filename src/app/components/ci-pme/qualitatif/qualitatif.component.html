<div class="mx-5 px-5 parent">
  <div class="card animate__animated animate__backInUp" style="border-radius: 10px">
    <div class="row" style="height: auto" *ngIf="!entreprise?.repQuali || edit">
      <div class="col-md-3 px-4 py-5">
        <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
          <a *ngFor="let p of listParameters" [ngClass]="{'active': p.id == 1}" class="nav-link"
             data-toggle="pill" href="#{{p.code}}"  role="tab" aria-controls="v-pills-home" aria-selected="true" (click)="activeTab(p.code)">
            <span class="badge badge-light rounded-circle">{{p.id}}</span> {{p.libelle}}
          </a>
        </div>
      </div>
      <div class="col-md-9 p-5" style="background-color: #f8f8f8">
        <div class="tab-content" id="v-pills-tabContent">
          <div *ngFor="let p of listParameters;" [ngClass]="{'active': p.id == 1}" class="tab-pane fade show active py-2" id="{{p.code}}">
            <h3 class="card-title font-weight-bold">{{p.libelle}}</h3>
            <p class="small text-muted">Veuillez répondre à toutes les questions !</p>

            <div class="row pt-3">
              <div id="accordion">
                <div class="card" *ngFor="let q of p.questions">
                  <div class="card-header" id="{{q.id}}">
                    <h5 class="mb-0">
                      <button class="btn btn-link" data-toggle="collapse" [attr.data-target]="'#'+q.question?.code" aria-expanded="false" [attr.aria-controls]="q.question?.code">
                        {{q.question?.libelle}}
                      </button>
                    </h5>
                  </div>

                  <div id="{{q.question?.code}}" class="collapse" [attr.aria-labelledby]="q.question?.id" data-parent="#accordion">
                    <div class="card-body">
                      <select class="form-control custom-select px-4 py-2" size="{{q.question?.listReponsesDTO?.length}}" [(ngModel)]="q.reponse" (change)="onSelectReponse($event, q)">
                        <option *ngFor="let r of q.question?.listReponsesDTO; let index = index" [value]="r.id">{{index+1}}) {{r.libelle}}</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
            <div class="modal-footer border-0">
                <button class="btn previous-btn" *ngIf="tabIndex != 0" (click)="activeTab('previous')" style="background-color: #f78300; color: #ffffff">Précédent</button>
                <button class="btn" style="background-color: #006a25; color: #ffffff" *ngIf="tabIndex != 6" (click)="activeTab('next')">Suivant</button>
                <button class="btn" style="background-color: #006a25; color: #ffffff" *ngIf="tabIndex == 6" (click)="submitQuestionnaire()">Valider</button>
              </div>
      </div>
    </div>
    <div class="row" style="height: auto" *ngIf="entreprise?.repQuali && !edit">
      <div class="col-md-12 p-5" style="background-color: #f8f8f8">
        <div class="col-md-12 d-center">
          <h4>Score Qualitatif</h4> 
        </div>
        <div class="row" >
          <div class="col-md-6">
            <table class="table table-striped">
              <thead>
              <tr>
                <th scope="col">Parametre Qualitatif</th>
                <th scope="col">Class</th>
              </tr>
              </thead>
              <tbody>
              <tr *ngFor="let s of scores">
                  <td>{{s.parametre?.libelle}}</td>
                  <td>{{s.score }}</td>
              </tr>
              </tbody>
              <tfoot>
                <tr>
                  <th>Total</th>
                  <th>{{ total }} </th>
                </tr>
                <tr>
                  <td></td>
                  <td>
                    <button class="btn" style="background-color: #006a25; color: #ffffff" *ngIf="entreprise?.repQuali" (click)="editScore(entreprise?.id)">Modifier</button>
                  </td>
                </tr>
              </tfoot>
            </table>
          </div>
          <div class="col-md-6">
            <canvas baseChart 
                [datasets]="chartValues"
                [options]="radarChartOptions"
                [labels]="chartLibelles"
                [chartType]="radarChartType"
                [legend]="true"
                [colors]="lineChartColors"
                ></canvas>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
